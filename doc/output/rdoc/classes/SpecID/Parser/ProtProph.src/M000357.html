<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>spec_id (SpecID::Parser::ProtProph)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre><span class="ruby-comment cmt"># File lib/spec_id/parser/proph.rb, line 176</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">spec_id</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">opts</span>={})
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;cannot do #{@version} yet&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@version</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">'4'</span>
    <span class="ruby-identifier">spec_id_obj</span> = 
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:spec_id</span>]
        <span class="ruby-identifier">x</span> 
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-constant">Proph</span><span class="ruby-operator">::</span><span class="ruby-constant">ProtSummary</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">protein_summary_n</span> = <span class="ruby-ivar">@get_root_node_from_file</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">file</span>)

    <span class="ruby-comment cmt">#protein_summary_n = scan_for_first(doc, 'protein_summary')</span>

    <span class="ruby-comment cmt"># protein_summary_header_n = protein_summary_n.child</span>
    <span class="ruby-comment cmt"># could grab some of this info if we wanted...</span>

    <span class="ruby-identifier">pep_hash</span> = {}
    <span class="ruby-identifier">prot_hash</span> = {}
    <span class="ruby-identifier">protein_groups</span> = []

    <span class="ruby-comment cmt"># get all the proteins from inside protein groups</span>
    <span class="ruby-identifier">protein_group_name</span> = <span class="ruby-value str">'protein_group'</span>
    <span class="ruby-identifier">get_protein_summary_header</span> = <span class="ruby-keyword kw">true</span>
    <span class="ruby-identifier">protein_summary_n</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">protein_group_n</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">get_protein_summary_header</span> 
        <span class="ruby-identifier">protein_summary_header_n</span> = <span class="ruby-identifier">protein_group_n</span>
        <span class="ruby-identifier">get_protein_summary_header</span> = <span class="ruby-keyword kw">false</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">protein_group_n</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">protein_group_name</span>
        <span class="ruby-identifier">protein_groups</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">get_proteins</span>(<span class="ruby-identifier">protein_group_n</span>, <span class="ruby-identifier">pep_hash</span>, <span class="ruby-identifier">prot_hash</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-comment cmt"># need to finalize hash stuff</span>
    <span class="ruby-identifier">pep_hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">pep</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">new_prots</span> = []
      <span class="ruby-identifier">pep</span>.<span class="ruby-identifier">prots</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prot_or_string</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prot_or_string</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proph</span><span class="ruby-operator">::</span><span class="ruby-constant">Prot</span>)
          <span class="ruby-identifier">new_prots</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">prot_or_string</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">prt</span> = <span class="ruby-identifier">prot_hash</span>[<span class="ruby-identifier">prot_or_string</span>]
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prt</span>.<span class="ruby-identifier">nil?</span>
            <span class="ruby-comment cmt"># this is an indistinguishable protein!</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">new_prots</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">prt</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">pep</span>.<span class="ruby-identifier">prots</span> = <span class="ruby-identifier">new_prots</span>
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-identifier">spec_id_obj</span>.<span class="ruby-identifier">peps</span> = <span class="ruby-identifier">pep_hash</span>.<span class="ruby-identifier">values</span>
    <span class="ruby-identifier">spec_id_obj</span>.<span class="ruby-identifier">prots</span> = <span class="ruby-identifier">prot_hash</span>.<span class="ruby-identifier">values</span>
    <span class="ruby-identifier">spec_id_obj</span>.<span class="ruby-identifier">prot_groups</span> = <span class="ruby-identifier">protein_groups</span>
    <span class="ruby-identifier">spec_id_obj</span>
  <span class="ruby-keyword kw">end</span></pre>
</body>
</html>